<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3c.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    >
	<ui:composition template="/templates/main.xhtml">
		<ui:define name="html_header_title">			
			#{msg['changePassword.title']}
		</ui:define>
		
		<ui:define name="html_header_content">
			<f:metadata>
				<f:viewAction action="#{userManager.validatePasswordResetToken()}" />
			</f:metadata>			
		</ui:define>

		<ui:define name="html_body_content">
			<div class="valign-wrapper" style="background-image: url(#{request.contextPath}/resources/images/blackmamba.png)" id="main-page">
				<div class="container">
					<div class="center-align" >
						<div class="row">
							<div class="col s6 offset-s3">
								<div class="container">
									<div id="change-password-panel" class="card">	
										<div class="card-title indigo darken-1">
											<div class="row">
												<div class="col s12 center-align" style="height: 15px;"/>
												<div class="col s12 center-align" style="height: 66px;">
													<img src="#{request.contextPath}/resources/images/password.png"/>
												</div>
												<div class="col s12 center-align" style="height: 15px;"/>
											</div>
										</div>
										<div class="card-content ">
											<span class="card-title">#{msg['changePassword.title']}</span>
											<div class="left-align">
												<h:form id="change-password-form">
													<div class="row">
														<div class="col s12" style="height: 10px;"/>
														<div class="col s12 center-align"> 
															<p:outputLabel escape="false" value="#{msg['changePassword.text']}" />
														</div>
														<div class="col s12" style="height: 10px;"/>
														<div class="col s12 center-align" style="height: 15px;">
															<p:outputLabel id="changePasswordMessage" value="#{messageBean.changePasswordMessage}" class="error-message" />
														</div>
														<div class="col s12" style="height: 10px;"/>
														<div class="col s12 input-field"> 
															<p:inputText id="newPassword" value="#{changePasswordFormBean.newPassword}" autocomplete="off" type="password"/>
															<p:outputLabel for="newPassword">#{msg['changePassword.newPassword']}</p:outputLabel>
														</div>
														<div class="col s12 input-field"> 
															<p:inputText id="newPasswordToConfirm" value="#{changePasswordFormBean.newPasswordToConfirm}" autocomplete="off" type="password"/>
															<p:outputLabel for="newPasswordToConfirm">#{msg['changePassword.newPasswordToConfirm']}</p:outputLabel>
														</div>
														<div class="col s12" style="height: 25px;"/>
														<div class="col s12">
															<div class="center-align">
																<p:commandButton id="changePassword" styleClass="waves-effect waves-light btn indigo darken-1" style="width: 100%;" type="submit"
														 		value="#{msg['action.changePassword']}" update="changePasswordMessage" action="#{userManager.changePassword()}" oncomplete="handleChangePasswordRequest(xhr, status, args)">
																</p:commandButton>
															</div>
														</div>														
													</div>
													<p:defaultCommand target="changePassword" />
												</h:form>
											</div>
										</div>
									</div>
								</div>	
							</div>
						</div>
					</div>
				</div>
			</div>
			<script>
				// Hohe ermitteln und div mitteilen
				$(document).ready(function() {
					$("#main-page").css("height", window.innerHeight);
				});
			</script>		
		</ui:define>
	</ui:composition>
</html>